
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Attendance</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">


  <!--
	//////////////////////////////////////////////////////

	FREE HTML5 TEMPLATE
	DESIGNED & DEVELOPED by FREEHTML5.CO

	Website: 		http://freehtml5.co/
	Email: 			info@freehtml5.co
	Twitter: 		http://twitter.com/fh5co
	Facebook: 		https://www.facebook.com/fh5co

	//////////////////////////////////////////////////////
	 -->

  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	

	<link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Simple Line Icons -->
	<link rel="stylesheet" href="css/simple-line-icons.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Owl Carousel  -->
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">
	<!-- Style -->
	<link rel="stylesheet" href="css/style.css">


	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>
	<body>
	<header role="banner" id="fh5co-header">
		<div class="fluid-container">
			<nav class="navbar navbar-default">
				<div class="navbar-header">
					<!-- Mobile Toggle Menu Button -->
					<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><i></i></a>
					<a class="navbar-brand" href="attendance.html"><span>Speech</span>&<span>Debate</span></a>
				</div>
				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav navbar-right">
						<li class="active"><a href="#" data-nav-section="home"><span>Home</span></a></li>
						<li><a href="#" data-nav-section="explore"><span>I'm an Existing Member!</span></a></li>
						<li class="call-to-action"><a href="#" data-nav-section="services"><span>I'm New!</span></a></li>
					</ul>
				</div>
			</nav>
	  </div>
	</header>

	<section id="fh5co-home" data-section="home" style="background-image: url(sdsd.png);" data-stellar-background-ratio="0.5">
		<div class="gradient"></div>
		<div class="container">
			<div class="text-wrap">
				<div class="text-inner">
					<div class="row">
						<div class="col-md-8 col-md-offset-2">
							<h1 class="to-animate"><span>Sign in and Record Attendance</span></h1>
							<h2 class="to-animate"></h2>
							<div class="call-to-action">
						</div>
					</div>
				</div>
			</div>
		</div>
    </div>
	</section>
	<section id="fh5co-explore" data-section="explore">
        <div class="container">
            <div class="col-md-12 to-animate">
			<h2 align="center">Sign In - Returning Members</h2>
			<form class="contact-form">
				<fieldset class="form-group">
					<label for="SId" class="sr-only">School ID - 5 Digit Number</label>
					<input type="number" name="SId" class="form-control" id="ajpat" required placeholder="School ID - Example: 12345"></input>
				</fieldset>
				<center>
				<button class="mainButton" id="attendanceButton">Record Attendance</button><br><br><br>
				</center>
			</form>
			
		</div>
	</section>
 
	<section id="fh5co-services" data-section="services">
		<div class="col-md-12 to-animate">
		<h2 align="center">Sign Up - New Members!</h2>
		<form class="contact-form">
		<fieldset class="form-group" align="center">
			<p><br><br>What school do you go to?</p>
				<select id="school" name="payment" required>
		          <option value="LAHS" selected>LAHS</option>
		          <option value="MVHS">MVHS</option>
		        </select>
		</fieldset>
			<fieldset class="form-group">
				<label for="email" class="sr-only">Email - Best way to Contact You!</label>
				<input type="email" name="email" class="form-control" id="registerEmail" placeholder="Email" required>
			</fieldset>
			<fieldset class="form-group">
				<label for="name" class="sr-only">Name</label>
				<input type="string" name="name" class="form-control" id="registerName" placeholder="Full Name" required>
			</fieldset>
			<fieldset class="form-group">
				<label for="SId" class="sr-only">School ID - 5 Digit Number</label>
				<input type="number" name="SId" class="form-control" id="schoolID" required placeholder="School ID - Example: 12345"></input>
			</fieldset>
		</form>
		<center>
		<button class="mainButton" id="register">Register</button><br><br><br>
		<p>Written by Arjun Patrawala & Erik Zhang</p>
		</center>
		</div>
		<div style="display:none;" id="thankyou_message" align="center">
			<h2><em>Thanks</em> for joining!
			Welcome to the team!</h2>
		</div>
	</section>



	<hr>

	<div style="display:none;" id="thankyou_message">
  		<h2><em>Thanks</em> for contacting us!
		We will get back to you soon!</h2>
	</div>
	<!--Firebase Scripts-->
	<script src="https://www.gstatic.com/firebasejs/5.4.1/firebase.js"></script>
	<script>
	  // Initialize Firebase
	    var config = {
		  apiKey: "AIzaSyBR6tFVgpEaJpk6IllwGDPUpgeO19ZKnZs",
		  authDomain: "mvhs-attendance.firebaseapp.com",
		  databaseURL: "https://mvhs-attendance.firebaseio.com",
		  projectId: "mvhs-attendance",
		  storageBucket: "mvhs-attendance.appspot.com",
	   	  messagingSenderId: "1031314748817"
	    };
	    firebase.initializeApp(config);
		var dateObject = new Date();
		function writeUserData(userId, name, email, schoolID, school) {
		  firebase.database().ref('users/' + userId).set({
			username: name,
			email: email,
			schoolID: schoolID,
			school: school,
			attendanceNum: 1,
			dates: [(dateObject.getMonth() + 1) + '/' + dateObject.getDate() + '/' + dateObject.getFullYear()]
		  });
		}
		var registerButton = document.getElementById("register");
		
		registerButton.onclick = function(){
			var rEmail = document.getElementById("registerEmail").value;
			var rName = document.getElementById("registerName").value;
			var school = document.getElementById("school").value;
			var SID = document.getElementById("schoolID").value;
			writeUserData(SID, rName, rEmail, SID, school);
			setTimeout(location.reload.bind(location), 100);
		}

		function recordAttendance(userId){
			return firebase.database().ref('/users/' + userId).once('value').then(function(snapshot) {
			var currentAttendance = snapshot.val().attendanceNum;
			var currentDates = snapshot.val().dates;
			currentDates.push((dateObject.getMonth() + 1) + '/' + dateObject.getDate() + '/' + dateObject.getFullYear());
			var updates = {};
			  updates['/users/' + userId + '/attendanceNum'] = currentAttendance + 1;
			  updates['/users/' + userId + '/dates'] = currentDates;

			return firebase.database().ref().update(updates);

		});
			
		}
		
		
		var attendanceButton = document.getElementById("attendanceButton");
		
		attendanceButton.onclick = function(e){
			e.preventDefault();
			var loginUserID = document.getElementById("ajpat").value;
			recordAttendance(loginUserID);
			setTimeout(location.reload.bind(location), 100);
		}
	</script>
	
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Stellar Parallax -->
	<script src="js/jquery.stellar.min.js"></script>
	<!-- Owl Carousel -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- Main JS (Do not remove) -->
	<script src="js/main.js"></script>
	</body>
</html>
